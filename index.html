<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>Caisse Loto â€” FC des Nestes</title>

  <style>
    html { -webkit-text-size-adjust: 100%; }
    html, body { width: 100%; height: 100%; }

    :root{
      --bg: #f6f7f9;
      --card: #ffffff;
      --border: #e5e7eb;

      --neutral: #9ca3af;
      --neutralBg: #f3f4f6;

      --blue: #2563eb;
      --blueBg: #eef6ff;

      --dark: #0b1220;

      --btn: 42px;
      --valW: 52px;
      --rowPadY: 8px;
      --rowPadX: 10px;
      --radius: 14px;

      --h1: 20px;
      --h3: 15px;
      --label: 15px;
      --price: 15px;
      --total: 28px;

      /* Hauteur approximative de la barre du bas (Total + bouton) */
      --bottomBarSpace: 140px;
    }

    @media (max-width: 380px){
      :root{
        --btn: 40px;
        --valW: 48px;
        --h1: 19px;
        --label: 14px;
        --price: 14px;
        --total: 27px;
        --bottomBarSpace: 150px;
      }
    }

    body{
      margin:0;
      background: var(--bg);
      font-family: Arial, Helvetica, sans-serif;
    }
    * { -webkit-tap-highlight-color: transparent; }

    .wrap{
      padding: 10px;
      /* âœ… IMPORTANT : laisse de la place pour que la liste ne soit pas cachÃ©e par la barre sticky */
      padding-bottom: calc(var(--bottomBarSpace) + env(safe-area-inset-bottom));
      min-height: 100%;
      box-sizing: border-box;
    }

    .card{
      width: 100%;
      max-width: none;
      margin: 0;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 6px 20px rgba(0,0,0,.08);
      padding: 10px;
      box-sizing: border-box;
    }

    h1{
      margin: 0 0 8px 0;
      font-size: var(--h1);
      line-height: 1.2;
    }

    .section{
      border-radius: var(--radius);
      padding: 8px;
      margin-top: 8px;
      border: 1px solid var(--border);
    }

    .section h3{
      margin: 0 0 8px 0;
      font-size: var(--h3);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge{
      font-size: 11px;
      font-weight: 900;
      padding: 4px 10px;
      border-radius: 999px;
      letter-spacing: .3px;
      color: #fff;
      white-space: nowrap;
    }

    .norm{ background: var(--neutralBg); }
    .norm .badge{ background:#374151; }

    .spec{ background: var(--blueBg); border-color:#cfe6ff; }
    .spec .badge{ background: var(--blue); }
    .spec h3{ color: var(--blue); }

    .list{
      display: flex;
      flex-direction: column;
      gap: 7px;
    }

    .item{
      display:flex;
      align-items:center;
      gap: 10px;
      background:#fff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: var(--rowPadY) var(--rowPadX);
      box-sizing: border-box;
    }
    .item.normRow{ border-left: 7px solid var(--neutral); }
    .item.specRow{ border-left: 7px solid var(--blue); }

    .label{ flex: 1; min-width: 0; }
    .label b{ display:block; font-size: var(--label); line-height: 1.15; }

    .price{ font-weight: 900; font-size: var(--price); white-space: nowrap; }

    .qty{ display:flex; align-items:center; gap: 8px; }

    button{
      touch-action: manipulation;
      -webkit-user-select: none;
      user-select: none;
      cursor: pointer;
    }

    .btn{
      width: var(--btn);
      height: var(--btn);
      border: 0;
      border-radius: 12px;
      background: #e5e7eb;
      font-size: 22px;
      font-weight: 900;
      line-height: 1;
    }
    .btn:active{ transform: scale(0.98); }

    .val{
      width: var(--valW);
      height: var(--btn);
      border: 1px solid #d0d5dd;
      border-radius: 12px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 18px;
      font-weight: 900;
      background:#fff;
    }

    /* Barre du bas sticky */
    .bottom-bar{
      position: fixed; /* âœ… encore plus stable que sticky */
      left: 10px;
      right: 10px;
      bottom: calc(10px + env(safe-area-inset-bottom));
      display: grid;
      gap: 8px;
      z-index: 999;
    }

    .total-bar{
      background: var(--dark);
      color: #fff;
      border-radius: var(--radius);
      padding: 10px 12px;
      display:flex;
      justify-content: space-between;
      align-items:center;
      box-shadow: 0 -8px 24px rgba(0,0,0,.18);
    }
    .total-bar .amt{
      font-size: var(--total);
      font-weight: 900;
      white-space: nowrap;
    }

    .raz{
      height: 44px;
      border: 0;
      border-radius: var(--radius);
      background: #e5e7eb;
      font-size: 16px;
      font-weight: 900;
    }
    .raz:active{ transform: scale(0.99); }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>ðŸ§¾ Caisse Loto â€” FC des Nestes</h1>

      <div class="section norm">
        <h3><span class="badge">NORMALES</span> Cartons personnels acceptÃ©s</h3>
        <div class="list" id="normal"></div>
      </div>

      <div class="section spec">
        <h3><span class="badge">SPÃ‰CIALES</span> Planches bleues</h3>
        <div class="list" id="spec"></div>
      </div>
    </div>
  </div>

  <!-- Barre fixe (ne recouvre plus le contenu grÃ¢ce au padding-bottom de .wrap) -->
  <div class="bottom-bar">
    <div class="total-bar">
      <div>Total Ã  payer</div>
      <div class="amt" id="total">0 â‚¬</div>
    </div>
    <button class="raz" id="raz">Remise Ã  zÃ©ro</button>
  </div>

<script>
  const itemsNormal = [
    { id:"c1",  label:"1 carton", price:3 },
    { id:"n6",  label:"Planche 6 cartons", price:10 },
    { id:"n12", label:"Planche 12 cartons", price:15 },
    { id:"n18", label:"Planche 18 cartons", price:20 },
    { id:"n24", label:"Planche 24 cartons", price:25 },
  ];

  const itemsSpec = [
    { id:"s3", label:"Planche 3 cartons", price:3 },
    { id:"s6", label:"Planche 6 cartons", price:6 },
  ];

  const state = Object.fromEntries([...itemsNormal, ...itemsSpec].map(i => [i.id, 0]));

  function renderItem(it, cssRow){
    return `
      <div class="item ${cssRow}">
        <div class="label"><b>${it.label}</b></div>
        <div class="price">${it.price}â‚¬</div>
        <div class="qty">
          <button class="btn" type="button" data-act="dec" data-id="${it.id}" aria-label="Moins">âˆ’</button>
          <div class="val" id="val-${it.id}">0</div>
          <button class="btn" type="button" data-act="inc" data-id="${it.id}" aria-label="Plus">+</button>
        </div>
      </div>
    `;
  }

  document.getElementById("normal").innerHTML = itemsNormal.map(it => renderItem(it, "normRow")).join("");
  document.getElementById("spec").innerHTML   = itemsSpec.map(it => renderItem(it, "specRow")).join("");

  function calc(){
    let total = 0;
    for (const it of itemsNormal) total += state[it.id] * it.price;
    for (const it of itemsSpec) total += state[it.id] * it.price;
    document.getElementById("total").textContent = total + " â‚¬";
  }

  function update(id){
    document.getElementById("val-" + id).textContent = state[id];
    calc();
  }

  document.addEventListener("click", (e) => {
    const btn = e.target.closest("button[data-act]");
    if (!btn) return;

    const id = btn.dataset.id;
    const act = btn.dataset.act;

    if (act === "inc") state[id] += 1;
    if (act === "dec") state[id] = Math.max(0, state[id] - 1);

    update(id);
  });

  document.getElementById("raz").addEventListener("click", () => {
    for (const k in state) state[k] = 0;
    for (const k in state) document.getElementById("val-" + k).textContent = "0";
    calc();
  });

  calc();
</script>
</body>
</html>
